<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div id="catalogsPage">
                <div class="catalogs-div panel-div">
                    <ng-container *ngIf="catalogState !== State.LOADING">
                        <div class="package-details-title pl-3">
                            {{ isCurrentUser ? "My Catalogs" : "Catalogs" }}
                        </div>
                        <p class="pr-4">
                            <span *ngIf="isCurrentUser" class="package-dark-gray pl-3"
                                >Catalogs represent a single individual or organization. All data packages belong to one
                                and only one catalog.</span
                            >
                            <span *ngIf="!isCurrentUser && myCatalogs.length > 0" class="package-dark-gray pl-3"
                                >Catalogs created by {{ username }}
                            </span>

                            <span *ngIf="!isCurrentUser && myCatalogs.length == 0" class="section-description">
                                Either {{ username }} has not created any catalogs, or you do not have permission to
                                view any of the catalogs they have created.
                            </span>
                        </p>

                        <div class="ml-3 mb-4" *ngIf="catalogState !== State.LOADING && isCurrentUser">
                            <a class="app-outlined-button" (click)="createCatalog()">Create A Catalog</a>
                        </div>
                    </ng-container>

                    <div class="container">
                        <table
                            aria-describedby="catalogTable"
                            *ngIf="catalogState === State.SUCCESS && myCatalogs && myCatalogs.length > 0"
                            mat-table
                            class="gray-table"
                            [dataSource]="myCatalogs"
                        >
                            <!-- Label column -->
                            <ng-container matColumnDef="name">
                                <th scope="col" mat-header-cell *matHeaderCellDef>Name</th>
                                <td class="table-content" mat-cell *matCellDef="let catalog">
                                    <a class="color-info" [routerLink]="['/' + catalog.identifier.catalogSlug]">{{
                                        catalog.displayName
                                    }}</a>
                                </td>
                            </ng-container>

                            <ng-container matColumnDef="public">
                                <th scope="col" mat-header-cell *matHeaderCellDef>Public</th>
                                <td class="table-content" mat-cell *matCellDef="let catalog">
                                    <mat-slide-toggle
                                        class="app-slide-toggle"
                                        [checked]="catalog.isPublic"
                                        (change)="updateCatalogVisibility(catalog, $event)"
                                    >
                                    </mat-slide-toggle>
                                </td>
                            </ng-container>

                            <!-- Actions column -->
                            <ng-container matColumnDef="actions">
                                <th scope="col" mat-header-cell *matHeaderCellDef>Actions</th>
                                <td mat-cell *matCellDef="let catalog">
                                    <a
                                        class="app-outlined-button mr-3"
                                        [class.disabled]="!canModifyCatalog(catalog.identifier.catalogSlug)"
                                        (click)="editCatalog(catalog)"
                                        >Edit</a
                                    >
                                    <a
                                        class="app-outlined-button"
                                        [class.disabled]="!canModifyCatalog(catalog.identifier.catalogSlug)"
                                        (click)="deleteCatalog(catalog)"
                                    >
                                        <span class="delete-txt">Delete</span>
                                    </a>
                                </td>
                            </ng-container>

                            <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
                            <tr mat-row *matRowDef="let row; columns: columnsToDisplay"></tr>
                        </table>
                        <div class="loading-container" *ngIf="catalogState === State.LOADING">
                            <mat-spinner [diameter]="40"></mat-spinner>
                        </div>
                    </div>
                </div>
            </div>

            <ng-template #deleteMyUsercatalog>
                <h2 matDialogTitle>Cannot delete your user catalog</h2>
                <mat-dialog-content>
                    <p>You can not delete the catalog that's the same as your username.</p>
                </mat-dialog-content>
                <mat-dialog-actions align="end">
                    <button mat-button matDialogClose>Close</button>
                </mat-dialog-actions>
            </ng-template>
        </div>
    </div>
</div>
